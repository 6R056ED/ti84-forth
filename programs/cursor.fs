: MIN 2DUP > IF NIP ELSE DROP THEN ;
: MAX 2DUP < IF NIP ELSE DROP THEN ;

: PEN
  0 0
  BEGIN
    KEY DUP 5 <>
  WHILE
    PAGE
    CASE
      1 OF SWAP 1+ 15 MIN SWAP ENDOF
      2 OF SWAP 1- 15 MIN SWAP ENDOF
      4 OF 1+ 7 MIN ENDOF
      3 OF 1- 7 MIN ENDOF
    ENDCASE
    2DUP
    AT-XY
    STAR
  REPEAT
  PAGE
  DROP
;

PEN
